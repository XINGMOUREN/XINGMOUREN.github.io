window.Win10={_version:"v1.1.2.4",_debug:!0,_bgs:{main:"",mobile:""},_countTask:0,_newMsgCount:0,_animated_classes:[],_animated_liveness:0,_switchMenuTooHurry:!1,_lang:"unknown",_iframeOnClick:{resolution:200,iframes:[],interval:null,Iframe:function(){this.element=arguments[0],this.cb=arguments[1],this.hasTracked=!1},track:function(n,e){if(this.iframes.push(new this.Iframe(n,e)),!this.interval){var i=this;this.interval=setInterval((function(){i.checkClick()}),this.resolution)}},checkClick:function(){if(document.activeElement){var n=document.activeElement;for(var e in this.iframes){var i;!(i=this.iframes[e].element.id)||document.getElementById(i)?n===this.iframes[e].element?!1===this.iframes[e].hasTracked&&(this.iframes[e].cb.apply(window,[]),this.iframes[e].hasTracked=!0):this.iframes[e].hasTracked=!1:delete this.iframes[e]}}}},_iframe_click_lock_children:{},_renderBar:function(){this._countTask<=0||$("#win10_btn_group_middle>.btn").css("width","calc("+1/this._countTask*100+"% - 1px )")},_handleReady:[],_hideShortcut:function(){var n=$("#win10 #win10-shortcuts .shortcut");n.removeClass("animated flipInX"),n.addClass("animated flipOutX")},_showShortcut:function(){var n=$("#win10 #win10-shortcuts .shortcut");n.removeClass("animated flipOutX"),n.addClass("animated flipInX")},_checkBgUrls:function(){var n=$("#win10>.img-loader"),e=!1;if(Win10.isSmallScreen()){if(Win10._bgs.mobile&&(n.each((function(){var n=$(this);n.attr("src")===Win10._bgs.mobile&&n.hasClass("loaded")&&(Win10._setBackgroundImg(Win10._bgs.mobile),e=!0)})),!e)){var i=$('<img class="img-loader" src="'+Win10._bgs.mobile+'" />');$("#win10").append(i),Win10._onImgComplete(i[0],(function(){i.addClass("loaded"),Win10._setBackgroundImg(Win10._bgs.mobile)}))}}else if(Win10._bgs.main&&(n.each((function(){var n=$(this);n.attr("src")===Win10._bgs.main&&n.hasClass("loaded")&&(Win10._setBackgroundImg(Win10._bgs.main),e=!0)})),!e)){i=$('<img class="img-loader" src="'+Win10._bgs.main+'" />');$("#win10").append(i),Win10._onImgComplete(i[0],(function(){i.addClass("loaded"),Win10._setBackgroundImg(Win10._bgs.main)}))}},_startAnimate:function(){setInterval((function(){var n=Win10._animated_classes.length,e=Win10._animated_liveness;0!==e&&0!==n&&$("#win10-menu").hasClass("opened")&&$("#win10-menu>.blocks>.menu_group>.block").each((function(){if(!$(this).hasClass("onAnimate")&&Math.random()<=e){var i=$(this),t=Win10._animated_classes[Math.floor(Math.random()*n)];i.addClass("onAnimate"),setTimeout((function(){i.addClass(t),setTimeout((function(){i.removeClass("onAnimate"),i.removeClass(t)}),3e3)}),2*Math.random()*1e3)}}))}),1e3)},_onImgComplete:function(n,e){if(n)var i=setInterval((function(){n.complete&&(e(n),clearInterval(i))}),50)},_setBackgroundImg:function(n){$("#win10").css("background-image","url("+n+")")},_settop:function(n){isNaN(n)||(n=this.getLayeroByIndex(n));var e=0;$(".win10-open-iframe").each((function(){z=parseInt($(this).css("z-index")),$(this).css("z-index",z-1),z>e&&(e=z)})),n.css("z-index",e+1)},_checkTop:function(){var n=0,e=0,i=null;$("#win10_btn_group_middle .btn.show").each((function(){var t=$(this).attr("index"),s=Win10.getLayeroByIndex(t).css("z-index");s>e&&(n=t,e=s,i=$(this))})),this._settop(n),$("#win10_btn_group_middle .btn").removeClass("active"),i&&i.addClass("active")},_renderContextMenu:function(n,e,i,t){if(this._removeContextMenu(),!0!==i){var s=$("<div class='win10-context-menu'><ul></ul></div>");$("#win10").append(s);for(var a=s.find("ul"),o=0;o<i.length;o++){var l=i[o];if("|"!==l)if("string"!=typeof l)if("object"!=typeof l);else{var c=$("<li>"+l[0]+"</li>");a.append(c),c.click(t,l[1])}else a.append($("<li>"+l+"</li>"));else a.append($("<hr/>"))}n+150>document.body.clientWidth&&(n-=150),e+s.height()>document.body.clientHeight&&(e-=s.height()),s.css({top:e,left:n})}},_removeContextMenu:function(){$(".win10-context-menu").remove()},_closeWin:function(n){$("#win10_"+n).remove(),layer.close(n),Win10._checkTop(),Win10._countTask--,Win10._renderBar()},_fixWindowsHeightAndWidth:function(){var n=$(".win10-open-iframe"),e=document.body.clientHeight;n.each((function(){var n=$(this),i=n.css("height");(i=parseInt(i.replace("px","")))+40>=e&&(n.css("height",e-40),n.find(".layui-layer-content").css("height",e-83),n.find(".layui-layer-content iframe").css("height",e-83))}))},_bind_open_windows:function(){$("#win10").on("click",".win10-open-window",(function(){if($this=$(this),""!==$this.data("url")){var title=$this.data("title")||"",areaAndOffset,bg=$this.data("icon-bg")?$this.data("icon-bg"):"";$this.data("icon-image")&&(title='<img class="icon '+bg+'" src="'+$this.data("icon-image")+'"/>'+title),$this.data("icon-font")&&(title='<i class="fa fa-fw fa-'+$this.data("icon-font")+" icon "+bg+'"></i>'+title),title||1!==$this.children(".icon").length||1!==$this.children(".title").length||(title=$this.children(".icon").prop("outerHTML")+$this.children(".title").html()),$this.data("area-offset")&&(areaAndOffset=$this.data("area-offset"),-1!==areaAndOffset.indexOf(",")&&(areaAndOffset=eval(areaAndOffset))),Win10.openUrl($this.data("url"),title,areaAndOffset)}}))},_init:function(){this._lang=(navigator.language||navigator.browserLanguage).toLowerCase(),$("#win10_btn_win").click((function(){Win10.commandCenterClose(),Win10.menuToggle()})),$("#win10_btn_command").click((function(){Win10.menuClose(),Win10.commandCenterToggle()})),$("#win10 .desktop").click((function(){Win10.menuClose(),Win10.commandCenterClose()})),$("#win10").on("click",".msg .btn_close_msg",(function(){var n=$(this).parent();$(n).addClass("animated slideOutRight"),setTimeout((function(){n.remove()}),500)})),$("#win10_btn_command_center_clean_all").click((function(){var n=$("#win10_command_center .msg");n.addClass("animated slideOutRight"),setTimeout((function(){n.remove()}),1500),setTimeout((function(){Win10.commandCenterClose()}),1e3)})),$("#win10_btn_show_desktop").click((function(){$("#win10 .desktop").click(),Win10.hideWins()})),$("#win10-menu-switcher").click((function(){if(!Win10._switchMenuTooHurry){Win10._switchMenuTooHurry=!0;var n="win10-menu-hidden",e=$("#win10-menu>.list"),i=$("#win10-menu>.blocks"),t=function(e){e.hasClass(n)?(e.addClass("animated slideInLeft"),e.removeClass("animated slideOutLeft"),e.removeClass(n)):(setTimeout((function(){e.addClass(n)}),450),e.addClass("animated slideOutLeft"),e.removeClass("animated slideInLeft"))};t(e),t(i),setTimeout((function(){Win10._switchMenuTooHurry=!1}),520)}})),$("#win10_btn_group_middle").click((function(){$("#win10 .desktop").click()})),$(document).on("click",".win10-btn-refresh",(function(){var n=$(this).attr("index"),e=Win10.getLayeroByIndex(n).find("iframe");e.attr("src",e.attr("src"))})),$(document).on("click",".win10-btn-change-url",(function(){var n=$(this).attr("index"),e=Win10.getLayeroByIndex(n).find("iframe");layer.prompt({title:Win10.lang("编辑网址","Edit URL"),formType:2,skin:"win10-layer-open-browser",value:e.attr("src"),area:["500px","200px"],zIndex:99999999999},(function(n,i){layer.close(i),layer.msg(Win10.lang("请稍候...","Hold on please..."),{time:1500},(function(){e.attr("src",n)}))}))})),$(document).on("mousedown",".win10-open-iframe",(function(){var n=$(this);Win10._settop(n),Win10._checkTop()})),$("#win10_btn_group_middle").on("click",".btn_close",(function(){var n=$(this).parent().attr("index");Win10._closeWin(n)})),$("#win10-menu .list").on("click",".item",(function(){var n=$(this);for(n.hasClass("has-sub-down")&&($("#win10-menu .list .item.has-sub-up").toggleClass("has-sub-down").toggleClass("has-sub-up"),$("#win10-menu .list .sub-item").slideUp()),n.next().hasClass("sub-item")&&n.toggleClass("has-sub-down").toggleClass("has-sub-up");n.next().hasClass("sub-item");)n.next().slideToggle(),n=n.next()})),$("#win10-btn-browser").click((function(){layer.prompt({title:Win10.lang("访问网址","Visit URL"),formType:2,value:"",skin:"win10-layer-open-browser",area:["300px","150px"],zIndex:99999999999},(function(n,e){layer.close(e),layer.msg(Win10.lang("请稍候...","Hold on please..."),{time:1500},(function(){Win10.openUrl(n,n)}))}))})),setInterval((function(){var n=new Date,e=n.getFullYear(),i=n.getMonth()+1,t=n.getDate(),s=n.getHours(),a=n.getMinutes();a<10&&(a="0"+a),$("#win10_btn_time").html(s+":"+a+"<br/>"+e+"/"+i+"/"+t)}),1e3),document.body.onbeforeunload=function(n){var e=Win10.lang("系统可能不会保存您所做的更改","The system may not save the changes you have made.");window.event?window.event.returnValue=e:n.returnValue=e},Win10.buildList(),Win10._startAnimate(),Win10.renderShortcuts(),$("#win10-shortcuts").removeClass("shortcuts-hidden"),Win10._showShortcut(),Win10.renderMenuBlocks(),$(window).resize((function(){Win10.renderShortcuts(),Win10._checkBgUrls(),Win10.isSmallScreen()||Win10._fixWindowsHeightAndWidth()})),$(document).on("focus",".win10-layer-open-browser textarea",(function(){$(this).attr("spellcheck","false")})),$(document).on("keyup",".win10-layer-open-browser textarea",(function(n){13===n.keyCode&&$(this).parent().parent().find(".layui-layer-btn0").click()})),setTimeout((function(){console.log(Win10.lang("本页由Win10-UI强力驱动\n更多信息：http://win10ui.yuri2.cn \nWin10-UI,轻松打造别具一格的后台界面 ","The page is strongly driven by Win10-UI.\nFor more info: http://win10ui.yuri2.cn.\n Win10-UI, easy to create a unique background interface."))}),2e3),$(document).click((function(n){n.button||Win10._removeContextMenu()})),$(document).on("contextmenu",".win10-context-menu",(function(n){n.preventDefault(),n.stopPropagation()})),Win10.setContextMenu("#win10",!0),Win10.setContextMenu("#win10>.desktop",[['<i class="fa fa-fw fa-star"></i> 收藏本页',function(){var n=window.location,e=document.title,i=navigator.userAgent.toLowerCase();if(i.indexOf("360se")>-1)layer.alert(Win10.lang("您的浏览器不支持,请按 Ctrl+D 手动收藏!","Your browser does not support, please press Ctrl+D to manual collection!"));else if(i.indexOf("msie 8")>-1)window.external.AddToFavoritesBar(n,e);else if(document.all)try{window.external.addFavorite(n,e)}catch(n){layer.alert(Win10.lang("您的浏览器不支持,请按 Ctrl+D 手动收藏!","Your browser does not support, please press Ctrl+D to manual collection!"))}else window.sidebar?window.sidebar.addPanel(e,n,""):layer.alert(Win10.lang("您的浏览器不支持,请按 Ctrl+D 手动收藏!","Your browser does not support, please press Ctrl+D to manual collection!"))}],['<i class="fa fa-fw fa-window-maximize"></i> '+Win10.lang("进入全屏","Enable Full Screen"),function(){Win10.enableFullScreen()}],['<i class="fa fa-fw fa-window-restore"></i> '+Win10.lang("退出全屏","Disable Full Screen"),function(){Win10.disableFullScreen()}],"|",['<i class="fa fa-fw fa-info-circle"></i> '+Win10.lang("关于","About Us"),function(){Win10.aboutUs()}]]),Win10.setContextMenu("#win10_btn_group_middle",[['<i class="fa fa-fw fa-window-maximize"></i> '+Win10.lang("全部显示","Show All Windows"),function(){Win10.showWins()}],['<i class="fa fa-fw fa-window-minimize"></i> '+Win10.lang("全部隐藏","Hide All Windows"),function(){Win10.hideWins()}],['<i class="fa fa-fw fa-window-close"></i> '+Win10.lang("全部关闭","Close All Windows"),function(){Win10.closeAll()}]]),setInterval((function(){var n=$("#win10-msg-nof.on-new-msg");n.length>0&&n.toggleClass("fa-commenting-o")}),600),$("body").keyup((function(n){if(n.ctrlKey)switch(n.keyCode){case 37:$("#win10_btn_win").click();break;case 38:Win10.showWins();break;case 39:$("#win10_btn_command").click();break;case 40:Win10.hideWins()}})),$("#win10-desktop-scene").length<1&&($("#win10-shortcuts").css({position:"absolute",left:0,top:0,"z-index":100}),$("#win10 .desktop").append("<div id='win10-desktop-scene' style='width: 100%;height: calc(100% - 40px);position: absolute;left: 0;top: 0; z-index: 0;background-color: transparent;'></div>")),Win10._bind_open_windows()},setBgUrl:function(n){this._bgs=n,this._checkBgUrls()},menuClose:function(){$("#win10-menu").removeClass("opened"),$("#win10-menu").addClass("hidden"),this._showShortcut(),$(".win10-open-iframe").removeClass("hide")},menuOpen:function(){$("#win10-menu").addClass("opened"),$("#win10-menu").removeClass("hidden"),this._hideShortcut(),$(".win10-open-iframe").addClass("hide")},menuToggle:function(){$("#win10-menu").hasClass("opened")?this.menuClose():this.menuOpen()},commandCenterClose:function(){$("#win10_command_center").addClass("hidden_right"),this._showShortcut(),$(".win10-open-iframe").removeClass("hide")},commandCenterOpen:function(){$("#win10_command_center").removeClass("hidden_right"),this._hideShortcut(),$(".win10-open-iframe").addClass("hide"),$("#win10-msg-nof").removeClass("on-new-msg fa-commenting-o")},renderShortcuts:function(){var n=parseInt($("#win10 #win10-shortcuts")[0].offsetHeight/100),e=0,i=0;$("#win10 #win10-shortcuts .shortcut").each((function(){$(this).css({left:82*e+10,top:100*i+10}),++i>=n&&(i=0,e++)}))},renderMenuBlocks:function(){$("#win10-menu .menu_group").each((function(){var n=$(this),e=n.children(".block"),i=0;e.each((function(){var n=$(this),e=n.attr("loc").split(","),t=n.attr("size").split(","),s=44*(e[1]-1)+40,a=44*t[1],o=s+a;o>i&&(i=o),n.css({top:s,left:44*(e[0]-1),width:44*t[0],height:a})})),n.css("height",i)}))},commandCenterToggle:function(){$("#win10_command_center").hasClass("hidden_right")?this.commandCenterOpen():this.commandCenterClose()},newMsg:function(n,e,i){var t=$('<div class="msg"><div class="title">'+n+'</div><div class="content">'+e+'</div><span class="btn_close_msg fa fa-close"></span></div>');$("#win10_command_center .msgs").prepend(t),t.find(".content:first,.title:first").click((function(){i&&i(t)})),layer.tips(Win10.lang("新消息:","New message:")+n,"#win10_btn_command",{tips:[1,"#3c6a4a"],time:3e3}),$("#win10_command_center").hasClass("hidden_right")&&$("#win10-msg-nof").addClass("on-new-msg")},getLayeroByIndex:function(n){return $("#layui-layer"+n)},isSmallScreen:function(n){return n||(n=768),document.body.clientWidth<n},enableFullScreen:function(){var n=document.documentElement;n.requestFullscreen?n.requestFullscreen():n.mozRequestFullScreen?n.mozRequestFullScreen():n.webkitRequestFullScreen?n.webkitRequestFullScreen():n.msRequestFullscreen&&document.body.msRequestFullscreen()},disableFullScreen:function(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen()},buildList:function(){$("#win10-menu .list .sub-item").slideUp(),$("#win10-menu .list .item").each((function(){$(this).next().hasClass("sub-item")&&($(this).addClass("has-sub-down"),$(this).removeClass("has-sub-up"))}))},openUrl:function(n,e,i){if(this._countTask>12)return layer.msg("您打开的太多了，歇会儿吧~"),!1;this._countTask++,n||(n="404"),n=n.replace(/(^\s*)|(\s*$)/g,"");var t,s;if(/^(https?:\/\/|\.\.?\/|\/\/?)/.test(n)||(n="http://"+n),n||(n="//yuri2.cn"),e||(e=n),this.isSmallScreen()||"max"===i)t=["100%",document.body.clientHeight-40+"px"],s=["0","0"];else if("object"==typeof i)t=i[0],s=i[1];else{var a,o;t=["80%","80%"],a=((a=parseInt($(window).height()))-.8*a)/2-41,o=((o=parseInt($(window).width()))-.8*o)/2-120,s=[Math.round(this._countTask%10*20+a)+"px",Math.round(this._countTask%10*20+100+o)+"px"]}var l=layer.open({type:2,shadeClose:!0,shade:!1,maxmin:!0,title:e,content:n,area:t,offset:s,isOutAnim:!1,skin:"win10-open-iframe",cancel:function(n,e){$("#win10_"+n).remove(),Win10._checkTop(),Win10._countTask--,Win10._renderBar()},min:function(n){return n.hide(),$("#win10_"+l).removeClass("show"),Win10._checkTop(),!1},full:function(n){n.find(".layui-layer-min").css("display","inline-block")}});$("#win10_btn_group_middle .btn.active").removeClass("active");var c=$('<div id="win10_'+l+'" index="'+l+'" class="btn show active"><div class="btn_title">'+e+'</div><div class="btn_close fa fa-close"></div></div>'),r=Win10.getLayeroByIndex(l);return r.css("z-index",Win10._countTask+813),Win10._settop(r),r.find(".layui-layer-setwin").prepend('<a class="win10-btn-change-url" index="'+l+'" title="'+Win10.lang("修改地址","Change URL")+'" href="javascript:void(0)"><span class="fa fa-chain"></span></a><a class="win10-btn-refresh" index="'+l+'" title="'+Win10.lang("刷新","Refresh")+'" href="javascript:void(0)"><span class="fa fa-refresh"></span></a>'),r.find(".layui-layer-setwin .layui-layer-max").click((function(){setTimeout((function(){var n=r.css("height");(n=parseInt(n.replace("px","")))>=document.body.clientHeight&&(r.css("height",n-40),r.find(".layui-layer-content").css("height",n-83),r.find(".layui-layer-content iframe").css("height",n-83))}),300)})),$("#win10_btn_group_middle").append(c),Win10._renderBar(),c.click((function(){var n=$(this).attr("index"),e=Win10.getLayeroByIndex(n);$(this).hasClass("show")?$(this).hasClass("active")?($(this).removeClass("active"),$(this).removeClass("show"),Win10._checkTop(),e.hide()):($("#win10_btn_group_middle .btn.active").removeClass("active"),$(this).addClass("active"),Win10._settop(e)):($(this).addClass("show"),$("#win10_btn_group_middle .btn.active").removeClass("active"),$(this).addClass("active"),Win10._settop(e),e.show())})),Win10._iframeOnClick.track(r.find("iframe:first")[0],(function(){0===Object.getOwnPropertyNames(Win10._iframe_click_lock_children).length?(Win10._settop(r),Win10._checkTop()):console.log("click locked")})),this.menuClose(),this.commandCenterClose(),l},closeAll:function(){$(".win10-open-iframe").remove(),$("#win10_btn_group_middle").html(""),Win10._countTask=0,Win10._renderBar()},setAnimated:function(n,e){this._animated_classes=n,this._animated_liveness=e},exit:function(){layer.confirm(Win10.lang("确认要关闭本页吗?","Are you sure you want to close this page?"),{icon:3,title:Win10.lang("提示","Prompt")},(function(n){document.body.onbeforeunload=function(){},window.location.href="about:blank",window.close(),layer.close(n),layer.alert(Win10.lang("哎呀,好像失败了呢。","Ops...There seems to be a little problem."),{skin:"layui-layer-lan",closeBtn:0})}))},lang:function(n,e){return"zh-cn"===this._lang||"zh-tw"===this._lang?n:e},aboutUs:function(){layer.open({type:1,closeBtn:1,anim:2,skin:"layui-layer-molv",title:"WIN10-UI "+this._version,shadeClose:!0,area:["320px","200px"],content:'<div style="padding: 10px;font-size: 12px"><p>支持组件:layer、jquery、animated.css、font-awesome</p><p>happyking©版权所有</p></div>'})},setContextMenu:function(n,e){"string"==typeof n&&(n=$(n)),n.unbind("contextmenu"),n.on("contextmenu",(function(n){e&&(Win10._renderContextMenu(n.clientX,n.clientY,e,this),n.cancelable&&(n.defaultPrevented||n.preventDefault()),n.stopPropagation())}))},hideWins:function(){$("#win10_btn_group_middle>.btn.show").each((function(){var n=$(this).attr("index"),e=Win10.getLayeroByIndex(n);$(this).removeClass("show"),$(this).removeClass("active"),e.hide()}))},showWins:function(){$("#win10_btn_group_middle>.btn").each((function(){var n=$(this).attr("index"),e=Win10.getLayeroByIndex(n);$(this).addClass("show"),e.show()})),Win10._checkTop()},getDesktopScene:function(){return $("#win10-desktop-scene")},onReady:function(n){Win10._handleReady.push(n)}},$((function(){for(var n in Win10._init(),Win10._handleReady){(0,Win10._handleReady[n])()}}));